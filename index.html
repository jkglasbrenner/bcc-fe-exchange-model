<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BCC Fe exchange model</title>
    <link rel="stylesheet" href="https://jkglasbrenner.github.io/bcc-fe-exchange-model/theme/css/site.min.css">
    <link rel="stylesheet" href="https://jkglasbrenner.github.io/bcc-fe-exchange-model/theme/css/notebook.css">
      <link rel="stylesheet" href="https://jkglasbrenner.github.io/bcc-fe-exchange-model/theme/css/vendor/katex/katex.min.css">
      <link rel="stylesheet" href="https://jkglasbrenner.github.io/bcc-fe-exchange-model/theme/css/vendor/highlightjs/default.css">
      <link rel="stylesheet" href="https://jkglasbrenner.github.io/bcc-fe-exchange-model/theme/css/vendor/fontawesome/fa-svg-with-js.css">
      <link href="https://jkglasbrenner.github.io/bcc-fe-exchange-model/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="BCC Fe exchange model Full Atom Feed" />
</head>  <body>
    <div class="content-grid-container">
  <article class="static-page">
<header class="article-header">
    <a href="https://github.com/jkglasbrenner/bcc-fe-exchange-model/" class="github-corner" aria-label="View source on Github">
      <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#063; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
      </svg>
    </a>
  <h1 class="article-title"><span class="caps">BCC</span> Fe Exchange&nbsp;Model</h1>
    <div class="article-byline">
        James K. Glasbrenner
    </div>
  <time class="article-datecreated" datetime="2018-08-08T10:00:00-04:00">Aug 08, 2018</time>
</header><div class="article-body">
  <style type="text/css">/*!
*
* IPython notebook
*
*/
/* <span class="caps">CSS</span> font colors for translated <span class="caps">ANSI</span> colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #<span class="caps">90CAF9</span>;
  border-left-color: #<span class="caps">E3F2FD</span>;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #<span class="caps">E3F2FD</span>;
  border-right-width: 1px;
  background: #<span class="caps">E3F2FD</span>;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #<span class="caps">42A5F5</span> -40px, #<span class="caps">42A5F5</span> 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #<span class="caps">42A5F5</span> -40px, #<span class="caps">42A5F5</span> 7px, #<span class="caps">E3F2FD</span> 7px, #<span class="caps">E3F2FD</span> 100%);
}
.edit_mode div.cell.selected {
  border-color: #<span class="caps">66BB6A</span>;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #<span class="caps">66BB6A</span> -40px, #<span class="caps">66BB6A</span> 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #<span class="caps">303F9F</span>;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In <span class="caps">CM2</span>, this used to be 0.4em, but in <span class="caps">CM3</span> it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In <span class="caps">CM3</span> this went to 4px from 0 in <span class="caps">CM2</span>. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #<span class="caps">BA2121</span>;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #<span class="caps">AA22FF</span>;
  font-weight: bold;
}
.highlight-meta {
  color: #<span class="caps">AA22FF</span>;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #<span class="caps">AA22FF</span>;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #<span class="caps">BA2121</span>;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #<span class="caps">AA22FF</span>;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but <span class="caps">FF</span> barfs all over that */
  height: 24em;
  /* <span class="caps">FF</span> needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/<span class="caps">FF</span> */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #<span class="caps">FF0000</span> } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #<span class="caps">BC7A00</span> } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #<span class="caps">FF0000</span> } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #<span class="caps">0044DD</span> } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #<span class="caps">BA2121</span> } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #<span class="caps">0000FF</span>; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #<span class="caps">AA22FF</span> } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #<span class="caps">D2413A</span>; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #<span class="caps">0000FF</span> } /* Name.Function */
.highlight .nl { color: #<span class="caps">A0A000</span> } /* Name.Label */
.highlight .nn { color: #<span class="caps">0000FF</span>; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #<span class="caps">AA22FF</span>; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #<span class="caps">BA2121</span> } /* Literal.String.Affix */
.highlight .sb { color: #<span class="caps">BA2121</span> } /* Literal.String.Backtick */
.highlight .sc { color: #<span class="caps">BA2121</span> } /* Literal.String.Char */
.highlight .dl { color: #<span class="caps">BA2121</span> } /* Literal.String.Delimiter */
.highlight .sd { color: #<span class="caps">BA2121</span>; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #<span class="caps">BA2121</span> } /* Literal.String.Double */
.highlight .se { color: #<span class="caps">BB6622</span>; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #<span class="caps">BA2121</span> } /* Literal.String.Heredoc */
.highlight .si { color: #<span class="caps">BB6688</span>; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #<span class="caps">BB6688</span> } /* Literal.String.Regex */
.highlight .s1 { color: #<span class="caps">BA2121</span> } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #<span class="caps">0000FF</span> } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #<span class="caps">3E424D</span>; }
.ansi-black-bg { background-color: #<span class="caps">3E424D</span>; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #<span class="caps">E75C58</span>; }
.ansi-red-bg { background-color: #<span class="caps">E75C58</span>; }
.ansi-red-intense-fg { color: #<span class="caps">B22B31</span>; }
.ansi-red-intense-bg { background-color: #<span class="caps">B22B31</span>; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #<span class="caps">DDB62B</span>; }
.ansi-yellow-bg { background-color: #<span class="caps">DDB62B</span>; }
.ansi-yellow-intense-fg { color: #<span class="caps">B27D12</span>; }
.ansi-yellow-intense-bg { background-color: #<span class="caps">B27D12</span>; }
.ansi-blue-fg { color: #<span class="caps">208FFB</span>; }
.ansi-blue-bg { background-color: #<span class="caps">208FFB</span>; }
.ansi-blue-intense-fg { color: #<span class="caps">0065CA</span>; }
.ansi-blue-intense-bg { background-color: #<span class="caps">0065CA</span>; }
.ansi-magenta-fg { color: #<span class="caps">D160C4</span>; }
.ansi-magenta-bg { background-color: #<span class="caps">D160C4</span>; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #<span class="caps">60C6C8</span>; }
.ansi-cyan-bg { background-color: #<span class="caps">60C6C8</span>; }
.ansi-cyan-intense-fg { color: #<span class="caps">258F8F</span>; }
.ansi-cyan-intense-bg { background-color: #<span class="caps">258F8F</span>; }
.ansi-white-fg { color: #<span class="caps">C5C1B4</span>; }
.ansi-white-bg { background-color: #<span class="caps">C5C1B4</span>; }
.ansi-white-intense-fg { color: #<span class="caps">A1A6B2</span>; }
.ansi-white-intense-bg { background-color: #<span class="caps">A1A6B2</span>; }

.ansi-bold { font-weight: bold; }
</style>
<style type="text/css">
div.cell, div.text_cell_render {
  padding: 0;
}

div.input_area > div.highlight {
  margin: 0;
  padding: 0.5em;
}

div.input_area {
  border: thin solid #bfbfbf;
  border-radius: 0;
  background: #f0f0f0;
}

div.input_area, div.output_area {
  margin-bottom: 1rem;
}

div.output_subarea {
  max-width: none;
}

div.output_text {
  border: thin solid #bfbfbf;
  border-radius: 0;
}

div.input_area pre, div.output_area pre {
  margin-bottom: 0!important;
}
</style>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Modules">Modules<a class="anchor-link" href="#Modules">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Import standard library&nbsp;modules:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="k">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="k">import</span> <span class="n">stdout</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Import external&nbsp;modules:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="kn">import</span> <span class="nn">sympy</span>
<span class="kn">from</span> <span class="nn">scipy.constants</span> <span class="k">import</span> <span class="n">Boltzmann</span><span class="p">,</span> <span class="n">electron_volt</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">symbols</span>
<span class="kn">from</span> <span class="nn">sympy.vector</span> <span class="k">import</span> <span class="n">CoordSys3D</span>
<span class="kn">from</span> <span class="nn">pymatgen</span> <span class="k">import</span> <span class="n">units</span>
<span class="kn">from</span> <span class="nn">pymatgen.transformations.standard_transformations</span> <span class="k">import</span> <span class="n">SupercellTransformation</span>
<span class="kn">from</span> <span class="nn">ruamel.yaml</span> <span class="k">import</span> <span class="n">YAML</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Set options, instantiate classes, and define global&nbsp;constants:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.colheader_justify&quot;</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.html.border&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">html_table_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;th&quot;</span><span class="p">,</span> <span class="s2">&quot;props&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;text-align&quot;</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">)]}</span>
<span class="n">yaml</span> <span class="o">=</span> <span class="n">YAML</span><span class="p">()</span>

<span class="n">kB</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">Boltzmann</span> <span class="o">/</span> <span class="n">electron_volt</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We also import functions from my own <a href="https://github.com/jkglasbrenner/datamaterials-neighbormodels">neighbormodels</a> module that I developed for counting neighbors in a periodic crystal&nbsp;system.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">neighbormodels.structure</span> <span class="k">import</span> <span class="n">from_file</span>
<span class="kn">from</span> <span class="nn">neighbormodels.neighbors</span> <span class="k">import</span> <span class="n">count_neighbors</span>
<span class="kn">from</span> <span class="nn">neighbormodels.interactions</span> <span class="k">import</span> <span class="n">build_model</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Theory-and-background">Theory and background<a class="anchor-link" href="#Theory-and-background">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Magnetic-ordering-and-the-exchange-interaction-[1]">Magnetic ordering and the exchange interaction [<a href="#glasbrenner2013_dissertation">1</a>]<a class="anchor-link" href="#Magnetic-ordering-and-the-exchange-interaction-[1]">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A handful of elemental materials and a vast number of compounds exhibit phases with magnetic ordering, the spontaneous alignment of spins in the absence of an external magnetic field.
There are three general cases of ordering: ferromagnetism, antiferromagnetism, and ferrimagnetism.
In ferromagnetic ordering all spins align parallel to one another, resulting in a macroscopic magnetization.
In antiferromagnetism the spins are aligned anti-parallel to one another and the net magnetization is zero.
Unlike the ferromagnetic case, antiferromagnetic order can be achieved via different topologies of moment ordering.
In some systems, such as materials with a triangular Kagome lattice crystal structure, different antiferromagnetic orderings can be degenerate or energetically similar, giving rise to magnetic frustration.
In ferrimagnetism, the spins order in some non-ferromagnetic way, but the magnetization is finite.
For example, this can occur in compounds with two different magnetic species with different net moments, so even if the magnetic ordering is reminiscent of an antiferromagnet, the different moment magnitudes lead to a net&nbsp;magnetization.</p>
<p>The origin of magnetic ordering is the so-called exchange interaction, which refers to the effect of electrostatic interactions competing with the Pauli exclusion principle.
There are several kinds of exchange, such as <em>direct exchange</em>, <em>superexchange</em>, <em>indirect exchange</em>, <em>itinerant exchange</em>, <em>double exchange</em>, and others.
Under the right conditions, the exchange interaction leads to an energetic preference for long-range magnetic ordering, with the aforementioned different kinds of exchange often preferring one type of magnetic order over another.
Building a general exchange interaction model that is compatible with all of the different kinds of exchange mechanisms and ordering patterns remains an immense theoretical&nbsp;challenge.</p>
<p>The classical Heisenberg model is one of the models used to describe magnetic systems, and it works best in systems where the spins are localized.
There has also been success in applying this model to materials with moderate levels of itinerancy.
For the rest of this tutorial, we will focus on the details of setting up and analyzing the Heisenberg model of magnetic exchange for real material&nbsp;systems.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Mean-field-approximation-to-the-Heisenberg-model">Mean-field approximation to the Heisenberg model<a class="anchor-link" href="#Mean-field-approximation-to-the-Heisenberg-model">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The classical Heisenberg model is written as&nbsp;follows,</p>
<p>\begin{equation}
  \text{H} = \sum_{\langle{}i,j\rangle{}} J_{ij} \mathbf{m}_{i} \cdot \mathbf{m}_{j},&nbsp;\end{equation}</p>
<p>where $i$ and $j$ are site indices, $\mathbf{m}_{i}$ is a classical vector representing the magnetic moment of site $i$, and $J_{ij}$ is the exchange constant for the interaction between sites $i$ and $j$ that parameterizes the spin-flip energy.
The range $\left\langle{}i,j\right\rangle{}$ indicates that the summation is over all possible site pairs in the&nbsp;lattice.</p>
<p>There is no known analytic solution to the classical three-dimensional Heisenberg model.
Exact numerical results are available using Monte Carlo simulations, which are straightforward to implement but can be computationally expensive.
The <em>mean-field approximation</em> (<span class="caps">MFA</span>) is a well-known and simple method for analyzing the Heisenberg model that has limitations, but is a reasonable starting point.
It also provides a method for computing exchange parameters using first-principles calculations by doing the&nbsp;following:</p>
<ol>
<li>Use density functional theory to compute the total energy of various magnetic patterns of a magnetic&nbsp;system.</li>
<li>Derive mean-field expressions for the Heisenberg model mapped to the crystal structure of the magnetic&nbsp;system.</li>
<li>Choose an interaction cutoff distance beyond which you assume the exchange parmeters are small enough to ignore.<ul>
<li>Model selection methods can be used to provide more rigor if the appropriate cutoff distance is not&nbsp;obvious.</li>
</ul>
</li>
<li>Use regression analysis to fit (train) the mean-field model on the total energy calculations to obtain the exchange&nbsp;parameters.</li>
</ol>
<p>What follows is a step-by-step derivation of the mean-field model of <span class="caps">BCC</span> Fe, which we will use to fit to energies computed via density functional theory calculations and obtain the Fe exchange parameters.
We will also use the mean-field model to find quick estimates of the Curie temperature based on the fitted exchange&nbsp;parameters.</p>
<p>We start by defining the spin fluctuation&nbsp;parameter,</p>
<p>\begin{equation}
  \delta{}\mathbf{m}_{i} \equiv \mathbf{m}_{i} - \left\langle{} \mathbf{m}_{i} \right\rangle{},&nbsp;\end{equation}</p>
<p>and using it to rewrite the&nbsp;Hamiltonian:</p>
<p>\begin{equation}
  \text{H} = \sum_{\langle{}i,j\rangle{}} J_{ij} \left( \left\langle{} \mathbf{m}_{i} \right\rangle{} + \delta{}\mathbf{m}_{i} \right) \cdot{} \left( \left\langle{} \mathbf{m}_{j} \right\rangle{} + \delta{}\mathbf{m}_{j} \right).&nbsp;\end{equation}</p>
<p>We have not made any approximations yet, just transformed the&nbsp;variables.</p>
<p>Next, we expand the formula so that we can see all multiplied terms.
Let&#8217;s use the <a href="https://www.sympy.org">sympy</a> module to help us with the symbolic manipulations, first by declaring our&nbsp;variables,</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">j_ij</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;J_ij&quot;</span><span class="p">)</span>
<span class="n">delta_m_i</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;𝛿m_i&quot;</span><span class="p">)</span>
<span class="n">delta_m_j</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;𝛿m_j&quot;</span><span class="p">)</span>
<span class="n">m_i_avg</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;&lt;m_i&gt;&quot;</span><span class="p">)</span>
<span class="n">m_j_avg</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;&lt;m_j&gt;&quot;</span><span class="p">)</span>
<span class="n">m_i</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;m_i&quot;</span><span class="p">)</span>
<span class="n">m_j</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;m_j&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>which allows us to to write down the formula inside the&nbsp;summation,</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">j_ij</span> <span class="o">*</span> <span class="p">(</span><span class="n">m_i_avg</span> <span class="o">+</span> <span class="n">delta_m_i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">m_j_avg</span> <span class="o">+</span> <span class="n">delta_m_j</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">



<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;m_i&gt;*&lt;m_j&gt;*J_ij + &lt;m_i&gt;*J_ij*𝛿m_j + &lt;m_j&gt;*J_ij*𝛿m_i + J_ij*𝛿m_i*𝛿m_j
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>We now apply the mean-field approximation</strong> by dropping spin-fluctuation terms of order $O\left(\delta{}m^{2}\right)$ and&nbsp;higher.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hamiltonian_mfa</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">hamiltonian</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">delta_m_i</span> <span class="o">*</span> <span class="n">delta_m_j</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hamiltonian_mfa</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">



<div class="output_subarea output_stream output_stdout output_text">
<pre>J_ij*(&lt;m_i&gt;*&lt;m_j&gt; + &lt;m_i&gt;*𝛿m_j + &lt;m_j&gt;*𝛿m_i)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The mean-field Hamiltonian&nbsp;is,</p>
<p>\begin{equation}
  \text{H}_{\text{mf}} \approx \sum_{\langle{}i,j\rangle{}} J_{ij} \left( \left\langle{} \mathbf{m}_{i} \right\rangle{} \cdot{} \left\langle{} \mathbf{m}_{j} \right\rangle{} + \left\langle{} \mathbf{m}_{i} \right\rangle{} \cdot{} \delta{}\mathbf{m}_{j} + \left\langle{} \mathbf{m}_{j} \right\rangle{} \cdot{} \delta{}\mathbf{m}_{i} \right)&nbsp;\end{equation}</p>
<p>The first term is just a constant shift of the energy, which we can remove by redefining the baseline energy for the&nbsp;Hamiltonian.</p>
<p>\begin{equation}
  \text{H}&#8217; \equiv \text{H}_{\text{mf}} + \left(\sum_{\langle{}i,j\rangle{}} J_{ij} \left\langle{} \mathbf{m}_{i} \right\rangle{} \cdot{} \left\langle{} \mathbf{m}_{j} \right\rangle{} \right)&nbsp;\end{equation}</p>
<p>For the other two terms, we take the definition for $\delta{}\mathbf{m}_{i}$ and substitute it back into our&nbsp;expression,</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">hamiltonian_mfa</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
    <span class="p">[(</span><span class="n">delta_m_i</span><span class="p">,</span> <span class="n">m_i</span> <span class="o">-</span> <span class="n">m_i_avg</span><span class="p">),</span>
     <span class="p">(</span><span class="n">delta_m_j</span><span class="p">,</span> <span class="n">m_j</span> <span class="o">-</span> <span class="n">m_j_avg</span><span class="p">)]</span>
<span class="p">))</span> <span class="o">+</span> <span class="n">j_ij</span> <span class="o">*</span> <span class="n">m_i_avg</span> <span class="o">*</span> <span class="n">m_j_avg</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">



<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;m_i&gt;*J_ij*m_j + &lt;m_j&gt;*J_ij*m_i
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our Hamiltonian now&nbsp;reads,</p>
<p>\begin{equation}
  \text{H}&#8217; = \sum_{\langle{}i,j\rangle{}} J_{ij} \left( \left\langle{} \mathbf{m}_{i} \right\rangle{} \cdot{} \mathbf{m}_{j} + \left\langle{} \mathbf{m}_{j} \right\rangle{} \cdot{} \mathbf{m}_{i} \right)&nbsp;\end{equation}</p>
<p>Since the site indices $i$ and $j$ are &#8220;dummy&#8221; indices and the above dot products are commutative, we can add together the terms to further simplify the&nbsp;expression,</p>
<p>\begin{equation}
  \text{H}&#8217; = 2 \sum_{\langle{}i,j\rangle{}} J_{ij} \left\langle{} \mathbf{m}_{j} \right\rangle{} \cdot{} \mathbf{m}_{i}&nbsp;\end{equation}</p>
<p>This form of the mean-field Hamiltonian is compact, but not the most convenient form for being able to write down models that map magnetic patterns to total energies computed using first-principles calculations.
To get our expression into a more convenient form, we transform the summation over site pairs as&nbsp;follows,</p>
<p>\begin{equation}
  \sum_{\langle{}i,j\rangle{}} \to \frac{1}{2 N_{\alpha{}}} \sum_{i} \sum_{\text{n}} \sum_{\alpha{} \leq \beta{}}&nbsp;\end{equation}</p>
<p>The above transformation redefines how we label the site pairs, introducing the sublattices $\alpha{}$ and $\beta{}$ and the neighbor index $n$.
The factor of $\frac{1}{2}$ accounts for double-counting of pairwise bonds and the factor $\frac{1}{N_{\alpha{}}}$ normalizes the summation with respect to the total number of sublattices $N_{\alpha{}}$.
This transforms our mean-field Hamiltonian as&nbsp;follows,</p>
<p>\begin{equation}
  \text{H}&#8217; = \frac{1}{N_{\alpha}} \sum_{i} \sum_{n} \sum_{\alpha{} \leq \beta{}} z_{n}^{\alpha{}\beta{}} J_{n}^{\alpha{}\beta{}} \left\langle{} \mathbf{m}^{\beta{}} \right\rangle{} \cdot{} \mathbf{m}_{i}^{\alpha{}}&nbsp;\end{equation}</p>
<p>For convenience, we can rewrite the summation over $\alpha{} \leq \beta{}$ into $\alpha = \beta$ and $\alpha \neq \beta$&nbsp;terms,</p>
<p>\begin{equation}
  \text{H}&#8217; = \sum_{i} \left( \frac{1}{N_{\alpha}} \sum_{\alpha{}} \sum_{n} z_{n}^{\alpha{}} J_{n}^{\alpha{}} \left\langle{} \mathbf{m}^{\alpha{}} \right\rangle{} \cdot{} \mathbf{m}_{i}^{\alpha{}} + \frac{1}{N_{\alpha{}}} \sum_{\alpha{},\beta{}\in{}\alpha{}\neq{}\beta{}} \sum_{n} z_{n}^{\alpha{}\beta{}} J_{n}^{\alpha{}\beta{}} \left\langle{} \mathbf{m}^{\beta{}} \right\rangle{} \cdot{} \mathbf{m}_{i}^{\alpha{}} \right)&nbsp;\end{equation}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sublattices">Sublattices<a class="anchor-link" href="#Sublattices">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The sublattice concept may be familiar if you&#8217;ve worked with alloys, but even if you haven&#8217;t, it&#8217;s straightforward to understand.
For a magnetic system, a complete set of sublattices&nbsp;must</p>
<ol>
<li>Define a unit cell (lattice with a basis) compatible with the full periodic crystal&nbsp;structure</li>
<li>Have all spins aligned in parallel within each&nbsp;sublattice.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Finite-temperature-behavior-of-mean-field-Heisenberg-model">Finite temperature behavior of mean-field Heisenberg model<a class="anchor-link" href="#Finite-temperature-behavior-of-mean-field-Heisenberg-model">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Calculating-exchange-parameters-of-BCC-Fe">Calculating exchange parameters of <span class="caps">BCC</span> Fe<a class="anchor-link" href="#Calculating-exchange-parameters-of-BCC-Fe">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Crystal-structure">Crystal structure<a class="anchor-link" href="#Crystal-structure">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At room temperature, <a href="#kohlhaas1967_ZAngewPhys">iron has the following crystal structure</a>:</p>
<table>
  <tr><td>Structure</td><td>Body-centered cubic</td></tr>
  <tr><td>Spacegroup</td><td>Im-3m (229)</td></tr>
  <tr><td>Lattice constants</td><td>a = 2.8665 Å</td></tr>
  <tr>
    <td>Basis</td>
    <td>Fe: [0.00 0.00 0.00]</td>
  </tr>
</table><p>A <span class="caps">CIF</span> file with these parmaeters that generates a conventional two-atom unit cell for <span class="caps">BCC</span> Fe is <a href="data/fe.cif">available here</a>.
We use this file to generate a <a href="http://pymatgen.org/">pymatgen</a> <code>Structure</code> object that will be convenient for building our magnetic exchange&nbsp;model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fe_cif_filepath</span> <span class="o">=</span> <span class="s2">&quot;data/fe.cif&quot;</span>
<span class="n">fe_structure_2atom</span> <span class="o">=</span> <span class="n">from_file</span><span class="p">(</span><span class="n">structure_file</span><span class="o">=</span><span class="n">fe_cif_filepath</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A quick printout of <code>fe_structure</code> confirms that we have the correct&nbsp;structure:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fe_structure_2atom</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">



<div class="output_subarea output_stream output_stdout output_text">
<pre>Full Formula (Fe2)
Reduced Formula: Fe
abc   :   2.866500   2.866500   2.866500
angles:  90.000000  90.000000  90.000000
Sites (2)
  #  SP      a    b    c
---  ----  ---  ---  ---
  0  Fe    0    0    0
  1  Fe    0.5  0.5  0.5
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To represent the f-type, a-type, and g-type magnetic patterns, we will need a four-atom cell instead of a two-atom cell.
We transform the supercell as&nbsp;follows:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rotate_cell_45_degrees</span> <span class="o">=</span> <span class="n">SupercellTransformation</span><span class="p">(</span>
    <span class="n">scaling_matrix</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span>
<span class="p">)</span>
<span class="n">fe_structure_4atom</span> <span class="o">=</span> <span class="n">rotate_cell_45_degrees</span><span class="o">.</span><span class="n">apply_transformation</span><span class="p">(</span><span class="n">fe_structure_2atom</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As expected, this results in the required 4-atom unit&nbsp;cell:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fe_structure_4atom</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">



<div class="output_subarea output_stream output_stdout output_text">
<pre>Full Formula (Fe4)
Reduced Formula: Fe
abc   :   4.053843   4.053843   2.866500
angles:  90.000000  90.000000  90.000000
Sites (4)
  #  SP      a    b     c
---  ----  ---  ---  ----
  0  Fe    0    0     0
  1  Fe    0.5  0.5  -0
  2  Fe    0.5  0     0.5
  3  Fe    1    0.5   0.5
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Mapping-magnetic-patterns-onto-sublattices">Mapping magnetic patterns onto sublattices<a class="anchor-link" href="#Mapping-magnetic-patterns-onto-sublattices">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Defining a magnetic pattern is straightforward and is achieved by assigning a spin direction to each site in a unit cell.
We adopt the conventional method for building a classical Ising or Heisenberg model by assuming that all spin amplitudes are equal in magnitude on all sites.
This allows us to specify a magnetic pattern by assigning +1 or -1 to each site.
This means unit cells with more sites allow you to define more unique magnetic patterns, which is useful if the magnetic energy landscape is complicated such that modeling these energies requires including more terms.
For this tutorial, the <span class="caps">BCC</span> Fe 4-atom cell will&nbsp;suffice.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fe_magnetic_patterns</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;data/fe_magnetic_patterns.yml&quot;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fe_magnetic_patterns</span><span class="p">[</span><span class="s2">&quot;4atoms&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">style</span> \
    <span class="o">.</span><span class="n">set_table_styles</span><span class="p">(</span><span class="n">html_table_style</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">hide_index</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">




<div class="output_html rendered_html output_subarea output_execute_result">
<style  type="text/css" >
    #T_f7d255ec_9eb5_11e8_b855_7d037a3c4fba  {
    }    #T_f7d255ec_9eb5_11e8_b855_7d037a3c4fba  {
    }</style>  
<table id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fba" > 
<thead>    <tr> 
        <th class="col_heading level0 col0" >nm</th> 
        <th class="col_heading level0 col1" >f-type</th> 
        <th class="col_heading level0 col2" >a-type</th> 
        <th class="col_heading level0 col3" >g-type</th> 
    </tr></thead> 
<tbody>    <tr> 
        <td id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fbarow0_col0" class="data row0 col0" >0</td> 
        <td id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fbarow0_col1" class="data row0 col1" >1</td> 
        <td id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fbarow0_col2" class="data row0 col2" >1</td> 
        <td id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fbarow0_col3" class="data row0 col3" >1</td> 
    </tr>    <tr> 
        <td id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fbarow1_col0" class="data row1 col0" >0</td> 
        <td id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fbarow1_col1" class="data row1 col1" >1</td> 
        <td id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fbarow1_col2" class="data row1 col2" >1</td> 
        <td id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fbarow1_col3" class="data row1 col3" >-1</td> 
    </tr>    <tr> 
        <td id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fbarow2_col0" class="data row2 col0" >0</td> 
        <td id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fbarow2_col1" class="data row2 col1" >1</td> 
        <td id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fbarow2_col2" class="data row2 col2" >-1</td> 
        <td id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fbarow2_col3" class="data row2 col3" >1</td> 
    </tr>    <tr> 
        <td id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fbarow3_col0" class="data row3 col0" >0</td> 
        <td id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fbarow3_col1" class="data row3 col1" >1</td> 
        <td id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fbarow3_col2" class="data row3 col2" >-1</td> 
        <td id="T_f7d255ec_9eb5_11e8_b855_7d037a3c4fbarow3_col3" class="data row3 col3" >-1</td> 
    </tr></tbody> 
</table> 
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Counting-neighbors-and-summing-over-sublattices">Counting neighbors and summing over sublattices<a class="anchor-link" href="#Counting-neighbors-and-summing-over-sublattices">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fe_neighbor_data</span> <span class="o">=</span> <span class="n">count_neighbors</span><span class="p">(</span><span class="n">cell_structure</span><span class="o">=</span><span class="n">fe_structure_4atom</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fe_exchange_model</span> <span class="o">=</span> <span class="n">build_model</span><span class="p">(</span><span class="n">magnetic_patterns</span><span class="o">=</span><span class="n">fe_magnetic_patterns</span><span class="p">[</span><span class="s2">&quot;4atoms&quot;</span><span class="p">],</span> <span class="n">neighbor_data</span><span class="o">=</span><span class="n">fe_neighbor_data</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Building-the-model-matrix">Building the model matrix<a class="anchor-link" href="#Building-the-model-matrix">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fe_dft_energies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="o">=</span><span class="s2">&quot;data/fe_magnetic_energies.csv&quot;</span><span class="p">)</span> 
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fe_model_matrix</span> <span class="o">=</span> <span class="n">fe_dft_energies</span> \
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">energy</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>
        <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;total_energy&quot;</span><span class="p">]</span> <span class="o">-</span>
         <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;pattern == &#39;nm&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;total_energy&quot;</span><span class="p">]))</span> <span class="o">*</span>
        <span class="mi">1000</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">Ha_to_eV</span> <span class="o">/</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;num_sites&quot;</span><span class="p">])</span> \
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">fe_exchange_model</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pattern&quot;</span><span class="p">])</span> \
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;pattern != &#39;nm&#39;&quot;</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">J1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;J1&quot;</span><span class="p">])</span> \
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">J2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;J2&quot;</span><span class="p">])</span> \
    <span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;pattern&quot;</span><span class="p">,</span> <span class="s2">&quot;energy&quot;</span><span class="p">,</span> <span class="s2">&quot;J1&quot;</span><span class="p">,</span> <span class="s2">&quot;J2&quot;</span><span class="p">]]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fe_model_matrix</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">(</span><span class="n">html_table_style</span><span class="p">)</span><span class="o">.</span><span class="n">hide_index</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">




<div class="output_html rendered_html output_subarea output_execute_result">
<style  type="text/css" >
    #T_f7e49798_9eb5_11e8_b855_7d037a3c4fba  {
    }    #T_f7e49798_9eb5_11e8_b855_7d037a3c4fba  {
    }</style>  
<table id="T_f7e49798_9eb5_11e8_b855_7d037a3c4fba" > 
<thead>    <tr> 
        <th class="col_heading level0 col0" >pattern</th> 
        <th class="col_heading level0 col1" >energy</th> 
        <th class="col_heading level0 col2" >J1</th> 
        <th class="col_heading level0 col3" >J2</th> 
    </tr></thead> 
<tbody>    <tr> 
        <td id="T_f7e49798_9eb5_11e8_b855_7d037a3c4fbarow0_col0" class="data row0 col0" >f-type</td> 
        <td id="T_f7e49798_9eb5_11e8_b855_7d037a3c4fbarow0_col1" class="data row0 col1" >-599.892</td> 
        <td id="T_f7e49798_9eb5_11e8_b855_7d037a3c4fbarow0_col2" class="data row0 col2" >8</td> 
        <td id="T_f7e49798_9eb5_11e8_b855_7d037a3c4fbarow0_col3" class="data row0 col3" >6</td> 
    </tr>    <tr> 
        <td id="T_f7e49798_9eb5_11e8_b855_7d037a3c4fbarow1_col0" class="data row1 col0" >a-type</td> 
        <td id="T_f7e49798_9eb5_11e8_b855_7d037a3c4fbarow1_col1" class="data row1 col1" >-133.324</td> 
        <td id="T_f7e49798_9eb5_11e8_b855_7d037a3c4fbarow1_col2" class="data row1 col2" >-8</td> 
        <td id="T_f7e49798_9eb5_11e8_b855_7d037a3c4fbarow1_col3" class="data row1 col3" >6</td> 
    </tr>    <tr> 
        <td id="T_f7e49798_9eb5_11e8_b855_7d037a3c4fbarow2_col0" class="data row2 col0" >g-type</td> 
        <td id="T_f7e49798_9eb5_11e8_b855_7d037a3c4fbarow2_col1" class="data row2 col1" >-375.406</td> 
        <td id="T_f7e49798_9eb5_11e8_b855_7d037a3c4fbarow2_col2" class="data row2 col2" >0</td> 
        <td id="T_f7e49798_9eb5_11e8_b855_7d037a3c4fbarow2_col3" class="data row2 col3" >-2</td> 
    </tr></tbody> 
</table> 
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Fitting-the-exchange-parameters-using-the-statsmodels-module">Fitting the exchange parameters using the statsmodels module<a class="anchor-link" href="#Fitting-the-exchange-parameters-using-the-statsmodels-module">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smf_exchange_fit</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">fe_model_matrix</span><span class="p">,</span> <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;energy ~ J1 + J2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smf_exchange_parameters</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">smf_exchange_fit</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;statsmodels&quot;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Fitting-the-exchange-parameters-using-the-scikit-learn-module">Fitting the exchange parameters using the scikit-learn module<a class="anchor-link" href="#Fitting-the-exchange-parameters-using-the-scikit-learn-module">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lm</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lm_exchange_fit</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">fe_model_matrix</span><span class="p">[[</span><span class="s2">&quot;J1&quot;</span><span class="p">,</span> <span class="s2">&quot;J2&quot;</span><span class="p">]],</span> <span class="n">y</span><span class="o">=</span><span class="n">fe_model_matrix</span><span class="p">[</span><span class="s2">&quot;energy&quot;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lm_exchange_parameters</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;sklearn&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">lm_exchange_fit</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">lm_exchange_fit</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lm_exchange_fit</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">1</span><span class="p">]]},</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Intercept&quot;</span><span class="p">,</span> <span class="s2">&quot;J1&quot;</span><span class="p">,</span> <span class="s2">&quot;J2&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Parameter-summary-for-both-methods">Parameter summary for both methods<a class="anchor-link" href="#Parameter-summary-for-both-methods">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smf_exchange_parameters</span> \
    <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lm_exchange_parameters</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> \
    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;parameter&quot;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">(</span><span class="n">html_table_style</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">hide_index</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">




<div class="output_html rendered_html output_subarea output_execute_result">
<style  type="text/css" >
    #T_f7edd178_9eb5_11e8_b855_7d037a3c4fba  {
    }    #T_f7edd178_9eb5_11e8_b855_7d037a3c4fba  {
    }</style>  
<table id="T_f7edd178_9eb5_11e8_b855_7d037a3c4fba" > 
<thead>    <tr> 
        <th class="col_heading level0 col0" >parameter</th> 
        <th class="col_heading level0 col1" >statsmodels</th> 
        <th class="col_heading level0 col2" >sklearn</th> 
    </tr></thead> 
<tbody>    <tr> 
        <td id="T_f7edd178_9eb5_11e8_b855_7d037a3c4fbarow0_col0" class="data row0 col0" >Intercept</td> 
        <td id="T_f7edd178_9eb5_11e8_b855_7d037a3c4fbarow0_col1" class="data row0 col1" >-373.206</td> 
        <td id="T_f7edd178_9eb5_11e8_b855_7d037a3c4fbarow0_col2" class="data row0 col2" >-373.206</td> 
    </tr>    <tr> 
        <td id="T_f7edd178_9eb5_11e8_b855_7d037a3c4fbarow1_col0" class="data row1 col0" >J1</td> 
        <td id="T_f7edd178_9eb5_11e8_b855_7d037a3c4fbarow1_col1" class="data row1 col1" >-29.1605</td> 
        <td id="T_f7edd178_9eb5_11e8_b855_7d037a3c4fbarow1_col2" class="data row1 col2" >-29.1605</td> 
    </tr>    <tr> 
        <td id="T_f7edd178_9eb5_11e8_b855_7d037a3c4fbarow2_col0" class="data row2 col0" >J2</td> 
        <td id="T_f7edd178_9eb5_11e8_b855_7d037a3c4fbarow2_col1" class="data row2 col1" >1.09971</td> 
        <td id="T_f7edd178_9eb5_11e8_b855_7d037a3c4fbarow2_col2" class="data row2 col2" >1.09971</td> 
    </tr></tbody> 
</table> 
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="References">References<a class="anchor-link" href="#References">&#182;</a></h2><ol>
<li>Adapted from <a id="glasbrenner2013_dissertation"></a> <a href="http://digitalcommons.unl.edu/physicsdiss/23/"><span class="caps">J. K.</span> Glasbrenner, <em>Ab-initio and model studies of spin fluctuation effects in transport and thermodynamics of magnetic metals</em>, Ph.D. dissertation, University of Nebraska (2013)</a>.</li>
<li><a id="kohlhaas1967_ZAngewPhys"></a> R. Kohlhaas, P. Donner, and N. Schmitz-Pranghe, Z. Angew. Phys. 23, 245&nbsp;(1967)</li>
</ol>

</div>
</div>
</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

</div>  </article>
    </div>
<footer class="page-footer">
    <div class="footer-grid-container">
      This content is released under a
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
        Creative Commons Attribution-ShareAlike 4.0 International License
      </a>.
    </div>
</footer><script src="https://jkglasbrenner.github.io/bcc-fe-exchange-model/theme/js/site.min.js"></script>
  <script src="https://jkglasbrenner.github.io/bcc-fe-exchange-model/theme/js/vendor/highlightjs/highlight.min.js"></script>
  <script src="https://jkglasbrenner.github.io/bcc-fe-exchange-model/theme/js/vendor/katex/katex.min.js"></script>
  <script src="https://jkglasbrenner.github.io/bcc-fe-exchange-model/theme/js/vendor/katex/contrib/auto-render.min.js"></script>
  <script src="https://jkglasbrenner.github.io/bcc-fe-exchange-model/theme/js/vendor/fontawesome/fontawesome-all.min.js"></script>
  <script src="https://jkglasbrenner.github.io/bcc-fe-exchange-model/theme/js/vendor/vendorInit.js"></script>
  <style>
   .github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}
  </style>
  </body>
</html>